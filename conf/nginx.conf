daemon off;
worker_processes  1;

events {
    worker_connections  1024;
}

http {
    radius_server         127.0.0.1:1812 "secret" "nas-identifier";
    radius_auth_timeout   5s;
    radius_auth_retries   3;
    radius_health_timeout 5s;
    radius_health_retries 1;

    server {
        listen       8081;
        server_name  localhost;

        location / {
            root   html;
            index  index.html index.htm;
        }

        location = /auth {
            auth_radius     "secret place";
            #auth_radius     off;

            try_files _nonexistent_ /auth_resp;
        }

        location = /auth_resp {
            internal;
            return 204 "";
        }

        location = /health {
            auth_radius_health "user" "passwd";
            try_files _nonexistent_ /health_up;
            error_page 500 503 = /health_down;
        }

        location = /health_up {
            internal;
            return 200 "up";
        }

        location = /health_down {
            internal;
            return 503 "down";
        }
    }
}
